<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8"/>
    </head>
    <body>
    <script>
    function loadDoc() {
        const xhr = new XMLHttpRequest();
        
        xhr.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var obj = JSON.parse(this.responseText);
                document.getElementById("demo").innerHTML = obj.id + " " + obj.username;
            }
            
        };
        xhr.open('get', 'http://localhost:8080/api/v1/user/3', true); // 
        xhr.send();
    }

    function listJob(job) {
        var routeList = job.route.split(";");
        var startingLocation = routeList.get(0);
        var destination = routeList.get(routeList.length - 1);

        var html = "<article class='post'>" +
            "<header>" + 
                "<div class='title'>" +
                    "<h2><a href='todolink.html?jobid=" + job.id + "'>" + startingLocation + " " + destination + "</a></h2>" +
                    "<p>" + job.description.substring(0, 30) + "...</p>" +
                "</div>" +
                "<div class='meta'>" +
                    "<time class='published' datetime='" + job.postDate + "'>" + job.postDate + "</time>" +
                    "<a href='#' class='author'><span class='name'>TODO: GET NAME</span><img src='images/avatar.jpg' alt='' /></a>" +
                "</div>" +
            "</header>" +
            "<a href='todolink.html?jobid=" + job.id + "' class='image featured'><img src='images/exemple_car.jpg' alt='' /></a>" +
			"<p>Calatoresc in scop personal de la Cluj-Napoca la Bucuresti, duminica, 1 decembrie si dispun de inca 2 locuri disponibile intr-o masina de 4+1 locuri.</p>" +
            "<footer>" +
                "<ul class='actions'>" +
                    "<li><a href='todolink.html?jobid=" + job.id + "' class='button large'>See offer</a></li>" +
                "</ul>" + 
                "<ul class='stats'>" +
                    "<li><a href='#'>" + job.tags.split(";").get(0) + "</a></li>" +
                    "<li><a href='#' class='icon solid fa-heart'>TODO:LIKES</a></li>" +
                    "<li><a href='#' class='icon solid fa-comment'>TODO:COMMENTS</a></li>" +
                "</ul>" +
            "</footer>" +
        "</article>";

        return html;
    }

    function updateHtml(item, index) {
        document.getElementById("main").innerHTML += listJob(item);
    }

    function updateJobs() {
        const xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var obj = JSON.parse(this.responseText);
                obj.forEach(updateHtml);
            }
        }

        xhr.open('get', 'http://localhost:8080/api/v1/job', true);
        xhr.send();
    }
        /*
<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="single.html">Cluj-Napoca - Buccuresti</a></h2>
										<p>(scurta descriere) Sofer calificat, masina curata</p>
									</div>
									<div class="meta">
										<time class="published" datetime="2015-11-01">November 24, 2019</time>
										<a href="#" class="author"><span class="name">Mihai Vifor</span><img src="images/avatar.jpg" alt="" /></a>
									</div>
								</header>
								<a href="single.html" class="image featured"><img src="images/exemple_car.jpg" alt="" /></a>
								<p>Calatoresc in scop personal de la Cluj-Napoca la Bucuresti, duminica, 1 decembrie si dispun de inca 2 locuri disponibile intr-o masina de 4+1 locuri.</p>
								<footer>
									<ul class="actions">
										<li><a href="single.html" class="button large">See offer</a></li>
									</ul>
									<ul class="stats">
										<li><a href="#">Carpooling</a></li>
										<li><a href="#" class="icon solid fa-heart">28</a></li>
										<li><a href="#" class="icon solid fa-comment">128</a></li>
									</ul>
								</footer>
							</article>
        */

    </script>

    <div id="demo">
      <h2>Let AJAX change this text</h2>
      <button type="button" onclick="loadDoc()">Change Content</button>
    </div>
        
    <div id="response">
        
    </div>

    </body>
</html>